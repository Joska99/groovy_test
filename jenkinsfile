pipeline { 
    agent {
        label 'agent1'
    }
    tools {
        docker '17.09.1-ce'
    }
    environment  {
        // Docker
        // DOCKER_CRET_PATH = ""
        IMG_NAME_APP = 'weather-app'
        VERSION = 'jenkins'
        // Helm
        HELM_PACKAGE_DIR = ''
        HELM_PACKAGE = ''
        HELM_REPO = ''
    }

    stages {
        // stage('checkout code') {
        //     steps {
        //         checkout scm
        //     }
        // }
        stage('build docker image') {
            when {
                branch 'main'
            }
            steps {
                script {
                    // print all ENV in Declarative mode
                    sh 'printenv'
                    docker.build("${IMG_NAME_APP}:${env.BUILD_NUMBER}", './jenkins_project/py_app/dockerfile')
                    // sh 'docekr --version'
                }
            }
        }
    }
}
