pipeline { 
    agent {
        label 'agent1'
    }
    // tools {
    //     docker 'lates'
    // }
    environment  {
        // Docker
        DOCKER_CRET_PATH = ""
        IMG_NAME_APP = 'weather-app'
        VERSION = 'jenkins'
        // Helm
        HELM_PACKAGE_DIR = ''
        HELM_PACKAGE = ''
        HELM_REPO = ''
    }

    stages {
        // stage('checkout code') {
        //     steps {
        //         checkout scm
        //     }
        // }
        stage('build docker image') {
            when {
                branch 'main'
            }
            steps {
                script {
                    sh 'printenv'
                    sh "echo $env.BRANCH_NAME"
                    // def newApp = docker.build "${IMG_NAME_APP}:${VERSION}"
                    // newApp.push 'latest'
                    def app = docker.build("${IMG_NAME_APP}:${VERSION}")
                    app.push()
                    // sh 'docekr --version'
                }
            }
        }
    }
}
